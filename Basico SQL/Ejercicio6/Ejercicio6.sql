
USE APPIA_INFO
GO

DROP DATABASE IF EXISTS [MoesDeveloper]
GO

DROP PROCEDURE IF EXISTS
[CREARDATA],
[TABLASKU],
[TBLLOTE],
[TBLPEDIDOS],
[FKSKUENPEDIDO],
[FKLOTEENPEDIDO],
[FKSKUENLOTE],
[CONSULTARDATA];
GO

DROP TABLE IF EXISTS
[SKU],
[LOTE],
[PEDIDOS];
GO

CREATE PROCEDURE CREARDATA
AS
BEGIN
CREATE DATABASE [MoesDeveloper]
END
GO
EXEC DBO.CREARDATA
GO

USE MoesDeveloper
GO

CREATE PROCEDURE TABLASKU
AS
BEGIN
CREATE TABLE SKU(
CodSKU INT PRIMARY KEY NOT NULL,
CodAlternativo VARCHAR(80) NOT NULL,
CodDepartamento VARCHAR(80) NOT NULL,
CodFamilia VARCHAR(80) NOT NULL,
CodSubFamilia VARCHAR(80) NOT NULL,
Stock INT NOT NULL,
UnidadBasica VARCHAR(80) NOT NULL,
CodBarras VARCHAR(80) NOT NULL,
Precio FLOAT NOT NULL,
)
END
GO
EXEC DBO.TABLASKU;
GO

CREATE PROCEDURE TBLLOTE
AS
BEGIN
CREATE TABLE LOTE(
CodLOTE INT PRIMARY KEY NOT NULL,
Descripcion1 VARCHAR(80) NOT NULL,
Descripcion2 VARCHAR(80) NOT NULL, 
FKLCODSKU INT NOT NULL,
)
END
GO
EXEC DBO.TBLLOTE;
GO

CREATE PROCEDURE TBLPEDIDOS
AS
BEGIN
CREATE TABLE PEDIDOS(
CodPEDIDO INT PRIMARY KEY NOT NULL,
NroDE VARCHAR(80) NOT NULL,
RefCliente1 VARCHAR(80) NOT NULL,
Refcliente2 VARCHAR(80) NOT NULL,
NroCliente INT NOT NULL,
NroLinea INT NOT NULL,
Unidades INT NOT NULL,
Estado VARCHAR(80) NOT NULL,
FKPCODSKU INT NOT NULL,
FKPCODLOTE INT NOT NULL,
)
END
GO
EXEC DBO.TBLPEDIDOS;
GO

CREATE PROCEDURE FKSKUENPEDIDO
AS
BEGIN
ALTER TABLE PEDIDOS ADD FOREIGN KEY (FKPCODSKU) REFERENCES SKU(CodSKU)
END
GO
EXEC DBO.FKSKUENPEDIDO;
GO

CREATE PROCEDURE FKLOTEENPEDIDO
AS
BEGIN
ALTER TABLE PEDIDOS ADD FOREIGN KEY (FKPCODLOTE) REFERENCES LOTE(CodLOTE)
END
GO
EXEC DBO.FKLOTEENPEDIDO
GO

CREATE PROCEDURE FKSKUENLOTE
AS
BEGIN
ALTER TABLE LOTE ADD FOREIGN KEY (FKLCODSKU) REFERENCES SKU(CodSKU)
END
GO
EXEC DBO.FKSKUENLOTE;
GO

CREATE PROCEDURE DATASKU
AS
BEGIN
INSERT INTO SKU (CodSKU,CodAlternativo,CodDepartamento,CodFamilia,CodSubFamilia,Stock,UnidadBasica,CodBarras,Precio) VALUES ('1000','SKU11000','1000SKU','VENTAS','TECNOLOGIA',800,'PALLET','SKU11000123456789',1247000);
INSERT INTO SKU (CodSKU,CodAlternativo,CodDepartamento,CodFamilia,CodSubFamilia,Stock,UnidadBasica,CodBarras,Precio) VALUES ('1001','SKU21000','1001SKU','VENTAS','TECNOLOGIA',800,'PALLET','SKU21000123456789',1246000);
INSERT INTO SKU (CodSKU,CodAlternativo,CodDepartamento,CodFamilia,CodSubFamilia,Stock,UnidadBasica,CodBarras,Precio) VALUES ('1002','SKU31000','1002SKU','VENTAS','TECNOLOGIA',800,'PALLET','SKU31000123456789',1245000);
INSERT INTO SKU (CodSKU,CodAlternativo,CodDepartamento,CodFamilia,CodSubFamilia,Stock,UnidadBasica,CodBarras,Precio) VALUES ('1003','SKU41000','1003SKU','VENTAS','TECNOLOGIA',800,'PALLET','SKU41000123456789',1244000);
INSERT INTO SKU (CodSKU,CodAlternativo,CodDepartamento,CodFamilia,CodSubFamilia,Stock,UnidadBasica,CodBarras,Precio) VALUES ('1004','SKU51000','1004SKU','VENTAS','TECNOLOGIA',800,'PALLET','SKU51000123456789',1243000);
INSERT INTO SKU (CodSKU,CodAlternativo,CodDepartamento,CodFamilia,CodSubFamilia,Stock,UnidadBasica,CodBarras,Precio) VALUES ('1005','SKU61000','1005SKU','VENTAS','TECNOLOGIA',800,'PALLET','SKU61000123456789',1242000);
END
GO
EXEC DBO.DATASKU;
GO


CREATE PROCEDURE DATALOTE
AS
BEGIN
INSERT INTO LOTE (CodLOTE,Descripcion1,Descripcion2,FKLCODSKU) VALUES ('2000','LOTE#1','CotenidoEnPallet','1000');
INSERT INTO LOTE (CodLOTE,Descripcion1,Descripcion2,FKLCODSKU) VALUES ('2001','LOTE#2','ContenidoEnPallet','1001');
INSERT INTO LOTE (CodLOTE,Descripcion1,Descripcion2,FKLCODSKU) VALUES ('2002','LOTE#3','ContenidoEnPallet','1002');
INSERT INTO LOTE (CodLOTE,Descripcion1,Descripcion2,FKLCODSKU) VALUES ('2003','LOTE#4','ContenidoEnPallet','1003');
INSERT INTO LOTE (CodLOTE,Descripcion1,Descripcion2,FKLCODSKU) VALUES ('2004','LOTE#5','ContenidoEnPallet','1004');
INSERT INTO LOTE (CodLOTE,Descripcion1,Descripcion2,FKLCODSKU) VALUES ('2005','LOTE#6','ContenidoEnPallet','1005');
END
GO
EXEC DBO.DATALOTE;
GO

CREATE PROCEDURE DATAPEDIDOS
AS
BEGIN
INSERT INTO PEDIDOS (CodPEDIDO,NroDE,RefCliente1,RefCliente2,NroCliente,NroLinea,Unidades,Estado,FKPCODSKU,FKPCODLOTE) VALUES ('3000','PED3000','CLIENTE#1','1023902431','30001','1','800','1','1000','2000');
INSERT INTO PEDIDOS (CodPEDIDO,NroDE,RefCliente1,RefCliente2,NroCliente,NroLinea,Unidades,Estado,FKPCODSKU,FKPCODLOTE) VALUES ('3001','PED3001','CLIENTE#2','1023902432','30002','2','900','1','1001','2001');
INSERT INTO PEDIDOS (CodPEDIDO,NroDE,RefCliente1,RefCliente2,NroCliente,NroLinea,Unidades,Estado,FKPCODSKU,FKPCODLOTE) VALUES ('3002','PED3002','CLIENTE#3','1023903431','30003','3','1000','2','1002','2002');
INSERT INTO PEDIDOS (CodPEDIDO,NroDE,RefCliente1,RefCliente2,NroCliente,NroLinea,Unidades,Estado,FKPCODSKU,FKPCODLOTE) VALUES ('3003','PED3003','CLIENTE#4','1023903432','30004','4','1001','2','1003','2003');
INSERT INTO PEDIDOS (CodPEDIDO,NroDE,RefCliente1,RefCliente2,NroCliente,NroLinea,Unidades,Estado,FKPCODSKU,FKPCODLOTE) VALUES ('3004','PED3004','CLIENTE#5','1023904431','30005','5','1002','3','1004','2004');
INSERT INTO PEDIDOS (CodPEDIDO,NroDE,RefCliente1,RefCliente2,NroCliente,NroLinea,Unidades,Estado,FKPCODSKU,FKPCODLOTE) VALUES ('3005','PED3005','CLIENTE#6','1023905432','30006','6','1003','4','1005','2005');
END
GO
EXEC DBO.DATAPEDIDOS
GO

CREATE PROCEDURE CONSULTARDATA
AS
BEGIN
SELECT * FROM [SKU];
SELECT * FROM [LOTE];
SELECT * FROM [PEDIDOS];
END
GO
EXEC DBO.CONSULTARDATA
GO
